:root{
  --bg:#0b1116; --panel:#0f1720; --ink:#e8eef7; --sub:#a7c7dd;
  --ok:#22c55e; --warn:#ffbf69; --bad:#f43f5e; --bar:#16232e; --line:#7aa2c1; --glow:#72f1a5;
  --safe-top: env(safe-area-inset-top); --safe-bottom: env(safe-area-inset-bottom);
}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{
  margin:0; background:var(--bg); color:var(--ink);
  font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","Hiragino Kaku Gothic ProN",Segoe UI,Roboto,Arial,system-ui,sans-serif;
  height:100%; min-height:100vh;
}
.sf{font-variant-numeric:tabular-nums}
#topbar{
  position:sticky; top:0; padding-top:var(--safe-top);
  background:linear-gradient(180deg,#0b1116 0%,#0b1116cc 100%);
  backdrop-filter:saturate(160%) blur(10px); z-index:10; border-bottom:1px solid #0f1a23
}
#topbar .row{display:flex;gap:10px;align-items:center;padding:8px 12px;flex-wrap:wrap}
#topbar label{font-size:12px;color:var(--sub);margin-right:6px}
#topbar select,#topbar input{
  background:#0e1a24;color:var(--ink);border:1px solid #1b2a38;border-radius:10px;
  padding:10px 12px;font-size:16px;min-width:92px
}
#topbar .compact select,#topbar .compact input{min-width:auto;width:92px}
#topbar .primary{background:var(--ok);border:0;color:#04110a}
#topbar .ghost{background:#13202b;border:1px solid #1b2a38;color:#cfe6f6}
#topbar button{border-radius:12px;padding:12px 16px;font-weight:700}
#topbar .version{margin-left:auto;color:#7d9db6;font-size:12px}
#topbar .micdb{margin-left:8px;font-weight:800}

#main{padding:10px;padding-bottom:calc(10px + var(--safe-bottom))}
#score-area{
  max-width:980px;margin:0 auto;background:var(--panel);border:1px solid #152331;border-radius:16px;
  padding:10px;position:relative
}
#staff-wrap{position:relative;border:1px solid #193041;border-radius:12px;background:#0e151c;margin-top:6px;overflow:hidden}
#staff{width:100%;height:auto;min-height:160px}
#fx{position:absolute;inset:0;pointer-events:none}

#advice{font-weight:800;font-size:22px;color:#ffccd5;text-shadow:0 2px 12px #0006;margin-top:4px}
#big-score{position:absolute;right:18px;margin-top:4px;font-size:32px;font-weight:900;color:#b9d6ea}

#prog{margin-top:6px;color:#8fb3cc}
#cents{margin-top:6px}
#cents .labels{display:flex;justify-content:space-between;color:#8fb3cc;font-size:12px}
#bar{height:10px;border-radius:6px;background:var(--bar);position:relative;overflow:hidden}
#needle{position:absolute;top:0;bottom:0;width:2px;background:var(--ok);left:50%}
button:disabled{opacity:.5}

.card{background:#0f1720;border:1px solid #183142;border-radius:16px;padding:16px;max-width:520px;margin:10vh auto}
#result[aria-hidden="true"],#error-modal[aria-hidden="true"]{display:none}
#praise{font-size:24px;font-weight:900;margin-bottom:6px}

/* --- tuner --- */
#tuner{
  display:flex;align-items:center;gap:12px;margin-top:6px;
  border:1px solid #183142;border-radius:10px;padding:8px;background:#0e151c;
}
#tuner .note{font-weight:900;font-size:26px;letter-spacing:1px}
#tuner .note #tun-oct{opacity:.7;margin-left:2px;font-size:18px}
#tuner .cents{flex:1}
#tuner .bar{height:8px;border-radius:6px;background:var(--bar);position:relative;overflow:hidden}
#tun-needle{position:absolute;top:0;bottom:0;width:2px;background:var(--ok);left:50%}
#tun-centnum{font-size:12px;color:#9ec3da;margin-top:2px;text-align:right}

/* マイク許可ゲート */
#mic-gate{position:fixed;inset:0;background:#000c;display:grid;place-items:center;z-index:9999}
#mic-gate[aria-hidden="true"]{display:none}
.gate-card{background:#0f1720;border:1px solid #183142;border-radius:16px;padding:20px;max-width:440px}
.gate-card h2{margin:0 0 8px}
.gate-card p{color:#9fbdd2;margin:0 0 12px}
.big{font-size:18px;padding:12px 18px}

/* モバイル最適化 */
@media (pointer:coarse){
  #topbar select,#topbar input{font-size:18px;padding:12px 14px}
  #topbar button{padding:14px 18px}
  #big-score{font-size:34px}
}
