/* style.css */
:root{
  --bg:#0b0d12; --fg:#e8eef7; --accent:#2dd4bf; --line:#1f2937;
  --good:#10b981; --mid:#f59e0b; --bad:#ef4444; --muted:#94a3b8;
}
*{box-sizing:border-box}
html,body{margin:0;padding:0;background:var(--bg);color:var(--fg);
  font-family:system-ui,-apple-system,"Segoe UI","Hiragino Kaku Gothic ProN","Yu Gothic",Roboto,sans-serif}

#topbar{position:fixed;inset:0 0 auto 0;height:46px;padding:0 8px;display:flex;align-items:center;justify-content:space-between;
  background:#0f131a;border-bottom:1px solid var(--line);z-index:10000}
#topbar .brand{font-weight:800;margin-right:8px}
#topbar .key-inline,.diff-inline{display:flex;align-items:center;gap:6px;font-size:12px}
#topbar select{appearance:none;background:#0f1822;color:var(--fg);border:1px solid var(--line);border-radius:8px;padding:6px 8px}
#topbar .sep{opacity:.6;margin:0 8px}
#topbar .version{font-size:11px;opacity:.7;margin-left:10px}
#topbar .db{font-size:12px;padding:2px 8px;border-radius:999px;background:#0d1117;border:1px solid var(--line)}
#topbar .a4{font-size:12px;opacity:.85;margin-right:8px}
#topbar .right{display:flex;align-items:center;gap:10px}

.seg{display:inline-grid;grid-auto-flow:column;gap:0;margin-right:8px;border:1px solid var(--line);border-radius:10px;overflow:hidden}
.seg input{display:none}
.seg label{padding:6px 10px;font-size:12px;cursor:pointer;background:#0f1822;color:#c9d5e3}
.seg input:checked+label{background:#1c2532;color:#fff;font-weight:800}

main{padding:60px 12px 16px;max-width:880px;margin:0 auto}
#controls{max-width:880px;margin:8px auto 10px;display:grid;gap:8px}
#controls .row{display:flex;gap:8px;flex-wrap:wrap;align-items:end}
#controls label{display:block;font-size:13px;flex:1;min-width:180px}
#controls select,#controls input{width:100%;padding:8px;border-radius:8px;border:1px solid var(--line);background:#0f131a;color:var(--fg)}
#controls .buttons{display:flex;gap:8px;min-width:260px}
button{flex:1;padding:10px 12px;border:0;border-radius:10px;font-weight:800;background:#111827;color:var(--fg);cursor:pointer}
#start{background:#2563eb} #stop{background:#6b7280}
#show-errors{background:#374151}
body.running #start{background:#10b981}

#hud{display:grid;grid-template-columns:1fr 220px;gap:12px;align-items:start}
@media (max-width:720px){ #hud{grid-template-columns:1fr} }

#score-panel{background:#0f131a;border:1px solid var(--line);border-radius:12px;padding:10px}
#big-score{font-size:36px;font-weight:900;text-align:center}
#advice{text-align:center;margin:4px 0 10px 0;font-size:18px;font-weight:800}
#advice.good{color:#b7ffcf} #advice.warn{color:#ffd89a} #advice.bad{color:#ffb3b3}

#bar-wrap{padding:0 6px}
#cents-scale{display:flex;justify-content:space-between;font-size:11px;color:#9ca3af;margin-bottom:6px}
#cents-bar{position:relative;height:16px;background:linear-gradient(90deg,#20242c 0%,#1d2a33 50%,#20242c 100%);
  border:1px solid var(--line);border-radius:999px;overflow:hidden}
#cents-bar::before{content:"";position:absolute;top:0;bottom:0;width:1px;background:#334155;left:50%}
#bar-needle{position:absolute;top:-4px;width:2px;height:24px;background:var(--accent);left:50%;
  box-shadow:0 0 8px rgba(45,212,191,.9)}
#bar-left-hint,#bar-right-hint{position:absolute;top:0;height:100%;display:flex;align-items:center;font-size:11px;font-weight:800;opacity:.0;transition:opacity .12s ease}
#bar-left-hint{left:6px;color:#87b3ff}
#bar-right-hint{right:6px;color:#ff9a9a}
#cents-bar.hint-low #bar-left-hint{opacity:1}  #cents-bar.hint-high #bar-right-hint{opacity:1}
#cents-bar.flash{box-shadow:0 0 0 3px rgba(34,197,94,.25) inset}

#analog{background:#0f131a;border:1px solid var(--line);border-radius:12px;padding:6px;display:flex;flex-direction:column;align-items:center}
#analog-svg{width:220px;height:110px}
#analog-svg .bezel{stroke:#233043;stroke-width:2}
#analog-svg .hand{stroke:var(--accent);stroke-width:2.4;stroke-linecap:round}
#analog-svg .cap{fill:var(--accent)}
#analog-svg .tick{stroke:#8aa1b8;stroke-width:.8}
#analog-svg .tick.major{stroke-width:1.6}
#analog-svg .label{fill:#9fb6cf;font-size:10px;text-anchor:middle}
.analog-caption{font-size:12px;opacity:.8;margin-top:2px}

#score-area{margin-top:10px}
.score-head{display:flex;align-items:center;justify-content:space-between;margin:4px 0 6px 0}
#staff-wrap{position:relative;width:100%;height:380px;background:#0f131a;border:1px solid var(--line);border-radius:12px;overflow:hidden}
#staff{position:absolute;inset:0}
#spark{position:absolute;inset:0;pointer-events:none}
#confetti-layer{position:absolute;left:0;right:0;bottom:0;height:0;pointer-events:none}

.note-normal{fill:#e8eef7;stroke:#e8eef7}
.note-target{fill:#22c55e;stroke:#22c55e}
.note-failed{fill:#ef4444;stroke:#ef4444}

#prog{font-size:13px;opacity:.9}
#page-label{font-size:12px;color:#9ca3af}

#hud-flash{position:fixed;inset:0;background:rgba(34,197,94,.12);opacity:0;pointer-events:none;transition:opacity .12s ease;z-index:9997}
#hud-flash.show{opacity:1}

#toast{position:fixed;left:0;right:0;bottom:0;padding:10px 12px;font-size:13px;text-align:center;
  background:rgba(40,40,40,.95);color:#fff;transform:translateY(100%);transition:transform .25s ease;z-index:9999}
#toast.show{transform:translateY(0)}
#toast.warn{background:#d97706} #toast.error{background:#b91c1c} #toast.info{background:#374151}
#toast.tiny{font-size:11px;padding:6px 8px}

.modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:9998}
.modal.show{display:flex}
.modal .card{position:relative; z-index:1; width:min(92%,560px); background:#0b1020; border:1px solid #20304a; border-radius:16px; padding:18px; text-align:center; box-shadow:0 10px 40px rgba(0,0,0,.5);}
.modal .label{font-size:14px;opacity:.8;margin-bottom:6px}
#praise{font-size:20px;margin:8px 0}
#details{font-size:12px;opacity:.85;margin-bottom:10px}
.modal .buttons{display:flex;gap:8px}
#again{background:#10b981} #close{background:#374151}
#permit{background:#2563eb}
#error-list{text-align:left;max-height:40vh;overflow:auto;font-size:12px;line-height:1.4}
#err-copy{background:#2563eb} #err-close{background:#6b7280}
